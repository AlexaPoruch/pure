<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:pure="http://beebole.com/pure">
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>Example 3 - Pure Unobtrusive Rendering Engine for HTML</title>
	    <link href="white.css" rel="alternate stylesheet" type="text/css" title="white"/>
	    <link href="black.css" rel="stylesheet" type="text/css" title="black"/>
		<script type="text/javascript" src="../js/jqueryMin.js"></script>
		<script type="text/javascript" src="../js/pure.js"></script>
		<script type="text/javascript" src="tutorial.js"></script>
		<script type="text/javascript">
			function transform(){
				var context = [
					"Alice Keasler", 
					"Charles LeGrand", 
					"Gary Bitemning", 
					"Helen Moren"];
				
				var directive1 = {'li' : 'player <-'};
				var directive2 = {'li' : 'player'};
				
				var html = document.getElementById('teamList');
				html = $p.map( directive1, html);
				html = $p.map( directive2, html);

				var target = document.getElementById('target');
				$p.render(html, context, target);}

			function libraryTransform(){
				$('#target').html( 
					$('#teamList')
				    .$pMap( {'li': 'player <-'})
					.$pMap( {'li': 'player'})
					.$pRender([
						"Alice Keasler", 
						"Charles LeGrand", 
						"Gary Bitemning", 
						"Helen Moren"]))}
		</script>
	</head>
	<body onload="transform()">
 		<div class="links"><a href="#" onclick="setActiveStyleSheet('black');return false;">Dark Night</a><span style="color:#52ABFF"> | </span><a href="#" onclick="setActiveStyleSheet('white');return false;">Bright Day</a>
				<br /><a href="quickStart.html">Quick Start</a><br />
				<a href="example1.html">Example 1</a><br />
				<a href="example2.html">Example 2</a><br />
				<a href="example3.html">Example 3</a><br />
				<a href="example4.html">Example 4</a><br />
				<a href="allExamples.html">All Examples</a><br />
				<a href="allExamplesCompiled.html">All Examples Compiled</a><br />
			<a href="http://groups.google.com/group/Pure-Unobtrusive-Rendering-Engine/post">Post</a> or <a href="mailto:Pure-Unobtrusive-Rendering-Engine@googlegroups.com">mail us</a><br /> your feedback
		</div>
		<h1>Example 3: A simple list of players</h1>
		The data we receive this time is an array of people.<br />
		And we will apply an HTML to format the data as an ordered list using the ol/li tags.<br />
		<p>Here below are all the steps explained.</p>
		<p class="note">If Javascript, JSON and CSS selectors are your daily food, you may want to jump directly to the <a href="allExamples.html" target="_blank">All examples page</a>.<br />
		Fire your JS debugger. Put a breakpoint and watch it running.</p>

		<h2>The HTML</h2>
		We design our HTML and CSS.<br />
<pre>&lt;ol id="teamList"&gt;
  &lt;li class="player"&gt;Player Name&lt;/li&gt;
&lt;/ol&gt;</pre>
		Which should look as below in your web browser:
		<ol id="teamList">
			<li class="player">Player Name</li>
		</ol>
		<p>We're done with our HTML and we can now start to put some action by javascript.<br />We select the HTML by its Id.</p>
		<pre>var html = document.getElementById( 'teamList' );</pre>


		<h2>The Context</h2>
		The JSON data contains now an array.
		<pre>var context = [
  "Alice Keasler", 
  "Charles LeGrand", 
  "Gary Bitemning", 
  "Helen Moren"];</pre>


		<h2>Mapping the context with the HTML</h2>
		We will now set the directives to link the data and the HTML and make an iteration.<br />
		<pre>var directive1 = {'li' : 'player &lt;-'};
var directive2 = {'li' : 'player'};</pre>
		<p class="note">It is very similar to the previous example, but as the context is the array, it is passed implicitly: 'player &lt;-' in directive1<br />
		As we just have one dimension to our array, there is no column index to be set such as 'player[0]', so we leave the array reference as is: 'player' in directive2.</p>

		The notation below is equivalent, and may be more explicit:
		<pre>var directive1 = {'li' : 'player &lt;- <span class="codeHi">context</span>'};
var directive2 = {'li' : 'player<span class="codeHi">[]</span>'};</pre>
  
		<p class="note">In both cases it means:<br />
		Select the element &lt;li&gt;. Repeat this element for each item you find in the context,  and assign to this item the name "player".<br />
		And select the element &lt;li&gt; again and set its node value to the value of "player".</p>
		<p class="note">Note: As our directive selects two times &lt;li&gt; we cannot put the commands in the same variable.<br />
		The second 'li' property would overwrite the first.<br />
		We have to split them in 2 directives. May be this could <a href="http://code.google.com/p/pure/issues/detail?id=10">change in the future</a></p>
		
		Then we map the directive to the HTML.
		<pre>html = $p.map( directive, html );</pre>


		<h2>Rendering</h2>
		In our page, we will now choose a site where we want to render our HTML.<br />
		Here the &lt;div&gt; with the id "target".
		<pre>&lt;div id="target"&gt;&lt;/div&gt;</pre>
		We select it in our javascript by its Id.
		<pre>var target = document.getElementById( 'target' );</pre>
		With the function $p.render( ) below, we apply the HTML to the context and place the result in the "target" element.
		<pre>$p.render( html, context, target )</pre>
		And you get the list:
		<div id="target"><span class="oops">Oops! Either your javascript is disabled or something is broken...</span></div>

		<h2>Putting all the JS commands together</h2>
		This first set of instructions is javascript as usual.
		<pre>function transform(){
  var context = [
    "Alice Keasler", 
    "Charles LeGrand", 
    "Gary Bitemning", 
    "Helen Moren"];

  var directive1 = {'li' : 'player &lt;-'};
  var directive2 = {'li' : 'player'};

  var html = document.getElementById('teamList');
  html = $p.map( directive1, html);
  html = $p.map( directive2, html);

  var target = document.getElementById('target');
  $p.render(html, context, target);}
</pre>
		And here again with a JS Library kind of syntax
		<pre>function libraryTransform(){
  $('#target').html( 
    $('#teamList')
      .$pMap( {'li': 'player &lt;-'})
      .$pMap( {'li': 'player'})
      .$pRender([
        "Alice Keasler", 
        "Charles LeGrand", 
        "Gary Bitemning", 
        "Helen Moren"]))}</pre>

		<h2>Conclusion</h2>
		 This example showed us how to handle context as an array and how to repeat another kind of HTML tag.<br />
		 We will now see how we can act inside a template execution by <a href="example4.html">passing a JS function as a directive</a>
	</body>
</html>