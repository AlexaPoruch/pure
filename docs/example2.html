<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:pure="http://beebole.com/pure">
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>Example 2 - Pure Unobtrusive Rendering Engine for HTML</title>
	    <link href="white.css" rel="alternate stylesheet" type="text/css" title="white"/>
	    <link href="black.css" rel="stylesheet" type="text/css" title="black"/>
		<script type="text/javascript" src="../js/jqueryMin.js"></script>
		<script type="text/javascript" src="../js/pure.js"></script>
		<script type="text/javascript" src="tutorial.js"></script>
		<script type="text/javascript">
			function transform(){
				var context = {'list':
					[["Alice Keasler", 14],
					["Charles LeGrand", 13],
					["Gary Bitemning",   20],
					["Helen Moren", 5],
					["Mary Cain",       15],
					["Vicky Benoit", 5],
					["Wayne Dartt", 11]]};
	
				var directive = {
					'tbody tr':  'player <- list',
					'td.player': 'player[0]',
					'td.score':  'player[1]'}

				var html = document.getElementById('teamList');
				html = $p.map( directive, html);
				var target = document.getElementById('target');
				$p.render(html, context, target);
			}
			function libraryTransform(){
				$('#target').html( 
					$('#teamList')
					.$pMap({
						'tbody tr':  'player <- list',
						'td.player': 'player[0]',
						'td.score':  'player[1]'})
					.$pRender({'list':
						[["Alice Keasler", 14],
						["Charles LeGrand", 13],
						["Gary Bitemning",   20],
						["Helen Moren", 5],
						["Mary Cain",       15],
						["Vicky Benoit", 5],
						["Wayne Dartt", 11]]}))}
		</script>
	</head>
	<body onload="transform()">
 		<div class="links"><a href="#" onclick="setActiveStyleSheet('black');return false;">Dark Night</a><span style="color:#52ABFF"> | </span><a href="#" onclick="setActiveStyleSheet('white');return false;">Bright Day</a>
				<br /><a href="quickStart.html">Quick Start</a><br />
				<a href="example1.html">Example 1</a><br />
				<a href="example2.html">Example 2</a><br />
				<a href="example3.html">Example 3</a><br />
				<a href="example4.html">Example 4</a><br />
				<a href="allExamples.html">All Examples</a><br />
				<a href="allExamplesCompiled.html">All Examples Compiled</a><br />
			<a href="http://groups.google.com/group/Pure-Unobtrusive-Rendering-Engine/post">Post</a> or <a href="mailto:Pure-Unobtrusive-Rendering-Engine@googlegroups.com">mail us</a><br /> your feedback
		</div>
		<h1>Example 2: A list of players and their score</h1>
		In <a href="example1.html">example 1</a> we saw how to pass information to an HTML and render it.<br />
		This second example is about iteration, and how to replicate HTML elements based on repetitive data.<br/>
		The data we receive this time is a list of people with their respective score. We will apply an HTML to format the data as a table.<br />
		<p>Here below are all the steps explained.</p>
		<p class="note">If Javascript, JSON and CSS selectors are your daily food, you may want to jump directly to the <a href="allExamples.html" target="_blank">All examples page</a>.<br />
		Fire your JS debugger. Put a breakpoint and watch it running.</p>

		<h2>The HTML</h2>
		We design our HTML and CSS.<br />
<pre>&lt;table id="teamList"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
	  &lt;th class="player"&gt;Player&lt;/th&gt;
	  &lt;th class="score"&gt;Score&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
	  &lt;td class="player"&gt;Chloe&lt;/td&gt;
	  &lt;td class="score"&gt;25&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</pre>
		Which should look like this in your web browser:
		<table id="teamList">
			<thead><tr><th class="player">Player</th><th class="score">Score</th></tr></thead>
			<tbody><tr><td class="player">Chloe</td><td class="score">25</td></tr></tbody>
		</table>
		We're done with our HTML and we can now start to put some action by javascript.<br />We select the HTML by its Id.<br />
		<pre>var html = document.getElementById( 'teamList' );</pre>


		<h2>The Context</h2>
		The JSON data contains now an array.
		<pre>var context = {'list':
	[["Alice Keasler", 34],
	["Charles LeGrand", 13],
	["Gary Bitemning", 50],
	["Helen Moren", 5],
	["Mary Cain", 15],
	["Vicky Benoit", 5],
	["Wayne Dartt", 11]]};</pre>


		<h2>Mapping the context to the HTML</h2>
		We will now set the directives to link the data and the HTML and make an iteration.
		<pre>var directive = {
  'tbody tr':  'player &lt;- list',
  'td.player': 'player[0]',
  'td.score':  'player[1]'}</pre>
  
		<p class="note">It means:<br />
		Select the element &lt;tbody&gt;&lt;tr&gt;. 
		Repeat this element for each item you find in the property:"list" from the context, and assign to this item the name "player".
		And link the tag &lt;td&gt; having the class "player" to the column 0 of the "player" item.<br />
		And link the tag &lt;td&gt; having the class "score" to the column 1 of the "player" item.</p>
		
		Then we map the directive to the HTML.
		<pre>html = $p.map( directive, html );</pre>


		<h2>Rendering</h2>
		In our page, we will now choose a site where we want to render our HTML.<br />
		Here the &lt;div&gt; with the id "target".
		<pre>&lt;div id="target"&gt;&lt;/div&gt;</pre>
		We select it in our javascript by its Id.
		<pre>var target = document.getElementById( 'target' );</pre>
		With the function $p.render( ) below, we apply the HTML to the context and place the result in the "target" element.
		<pre>$p.render( html, context, target )</pre>
		And you get this even more amazing result:
		<div id="target"><span class="oops">Oops! Either your javascript is disabled or something is broken...</span></div>

		<h2>Putting all the JS commands together</h2>
		This first set of instructions is javascript as usual.
		<pre>function transform(){
  var context = {'list':
    [["Alice Keasler", 14], 
    ["Charles LeGrand", 13],
    ["Gary Bitemning",   20],
    ["Helen Moren", 5],
    ["Mary Cain",       15],
    ["Vicky Benoit", 5],
    ["Wayne Dartt", 11]]};

  var directive = {
    'tbody tr':  'player &lt;- list',
    'td.player': 'player[0]',
    'td.score':  'player[1]'}

  var html = document.getElementById('teamList');
  html = $p.map( directive, html);
  var target = document.getElementById('target');
  $p.render(html, context, target);
}</pre>
		And here again with a JS Library kind of syntax
		<pre>function libraryTransform(){
  $('#target').html( 
    $('#teamList')
    .$pMap({
      'tbody tr':  'player &lt;- list',
      'td.player': 'player[0]',
      'td.score':  'player[1]'})
    .$pRender({'list':
      [["Alice Keasler", 14],
      ["Charles LeGrand", 13],
      ["Gary Bitemning",   20],
      ["Helen Moren", 5],
      ["Mary Cain",       15],
      ["Vicky Benoit", 5],
      ["Wayne Dartt", 11]]}))}</pre>
		<h2>Conclusion</h2>
		 This example showed us the repetition of table rows with various columns based on a named array "list" within the context.<br />
		 Now we will see what happens when the context itself is a simple array of one dimension through a <a href="example3.html">simple HTML list</a>
	</body>
</html>