<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:pure="http://beebole.com/pure">
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>Tutorial - Pure Unobtrusive Rendering Engine for HTML</title>
	    <link href="white.css" rel="stylesheet" type="text/css" title="black"/>
		<style type="text/css">
			#pureRuntime{width:100%;height:200px;background-color:#DEF}
			.htmlDoc{width:90%;background-color:#def;}
			.transformation{width:90%;background-color:#DEF;}
			.demo{border:solid 1px #ccc;background-color:#def;padding:10px}
		</style>
		<script type="text/javascript" src="../../library/jquery.js"></script>
		<script type="text/javascript" src="../js/pure.js"></script>
		<script type="text/javascript">
			function render1(){ 
				$('#hello').$pTransform({ "firstName": "Mary" } );}
				
			function lineClick(name){ alert(name); } // example1 of event attachment, still some research needed

			function swapStyle(obj, inOut){ // example2 for mouseover, mouseout
				obj.className = (inOut) ? 'player hover' : 'player';};
				
			function render2(){
				var context = ["Alice Keasler", "Charles LeGrand", "Gary Bitemning", "Helen Moren"];
				
				var players = $('table.players')
				.$pMap( {'tbody tr' : 'player <-',
					'tbody tr td[onclick]':function(context,items, pos){ return 'lineClick(\''+items[pos]+'\');'},
					'tbody tr td[onmouseover]': '"swapStyle(this, true);"',
					'tbody tr td[onmouseout]' : '"swapStyle(this, false);"', //both '"..."' and "'...'" work now
					'tbody tr td[style]':"'cursor:pointer'",
					'tbody tr td' : 'player'});

				$p.compile(players, 'f2');
				$('#render2').html( $p.render('f2', context) );}

			function render3(){
				var context = {
					"id": "3456",
					sites: [{ 
						"name": "Beebole","url": "http://beebole.com"}, {
						"name": "BeeLit", "url": "http://beeLit.com"}, {
						"name": "PURE",	  "url": "http://beebole.com/pure"}]};
				
				$('ol.teamList').$pTransform(context);}

			function render4(){
				var context =["Alice Keasler", "Charles LeGrand", "Gary Bitemning", "Helen Moren"];
				
				var players2 = $('table.players.2')
				.$pMap( {'tbody tr' : 'player <- context',
					'tbody tr td' : 'player[]',
					'tbody tr[class]': function(context, items, pos){return (pos % 2 == 0) ? 'even' : 'odd';}});
		        $p.compile(players2, 'f4');
				$('#render4').html( $p.render('f4', context) );}


			var row = {
				odd: 'odd',
				even:'even',
				decorator: function(context, items, pos){
					return (pos % 2 == 1) ? this.even : this.odd;}}
					
			function lineNb(context, items, pos){
				return pos+1;}
				
			function render5(){
				var context = {
					'list': [['Cats', 
								[["Alice Keasler", 14], 
								["Charles LeGrand", 13], 
								["Gary Bitemning", 20], 
								["Helen Moren", 5]]], 
					
							['Cows', [["Mary Cain", 15], ["Vicky Benoit", 5], ["Wayne Dartt", 11]]], ['Dogs', [["Ray Braun", 13], ["Aaron Ben", 24], ["Steven Smith", 1], ["Kim Caffey", 19]]], ['Donkeys', [["Natalie Kinney", 16], ["Caren Cohen", 3]]]]};
				
				var scoreBoard = $('table.scoreBoard').$pMap({
					'tbody tr': 'teams <- list',
					'td.teamName': 'teams[0]'
				});
				
				var teamList = $('table.teamList', scoreBoard)
					.$pMap({
						'tbody tr': 'player <- teams[1]',
						'td.player': 'player[0]',
						'td.score': 'player[1]',
						'td.position': lineNb, //passing the pointer of a function that does not use "this"
						'tbody tr[class]': function(context, items, pos){ return row.decorator(context, items, pos) } }); //show how to wrap a method and not breack the use of "this"
				
				$('td.teamPlace', scoreBoard).html(teamList);
				$p.compile(scoreBoard, 'f5');
		        $('#render5').html( $p.render('f5', context) );}
				
			function render6(){
			
				var context = [ 
					{"name" : "Home", "url" : "#ho"}, 
					{"name" : "About", "url" : "http://about...", 
						"subMenu" : [
							{"name" : "History", "url" : "http://history..."},
							{"name" : "Team", "url" : "http://team..."},
							{"name" : "Offices", "url" : "http://offices...",
								"subMenu" : [
									{"name" : "Brussels", "url" : "http://brussels..."},
									{"name" : "New Delhi", "url" : "http://newdelhi..."}]}]},
			        {"name" : "Services", "url" : "http://services...",
						"subMenu" : [
							{"name" : "Web Design", "url" : "http://web..."},
							{"name" : "Development", "url" : "http://dev..."}]}];
			               
				var directive = {
				  "li" : "menu <-",
				  "a" : "menu.name", 
				  "a[href]" : "menu.url",
			     	  "ul.nav1 li" : "sub1 <- menu.subMenu",
			     	  "ul.nav1 li a" : "sub1.name", 
				  "ul.nav1 li a[href]" : "sub1.url",
			     	  "ul.nav2 li" : "sub2 <- sub1.subMenu",
			     	  "ul.nav2 li a" : "sub2['name']", //same result as sub2.name
				  "ul.nav2 li a[href]" : "sub2.url"};
				var menu = $('ul#nav').$pMap(directive);
				$p.compile(menu, 'f6');
				$('ul#nav').replaceWith( $p.render('f6', context));}

			function renderAll(){ render1();render2();render3();render4();render5();render6();}
		</script>
	</head>
	<body>
 		<div class="links"><a href="#" onclick="setActiveStyleSheet('black');return false;">Dark Night</a><span style="color:#52ABFF"> | </span><a href="#" onclick="setActiveStyleSheet('white');return false;">Bright Day</a>
				<br /><a href="quickStart.html">Quick Start</a><br />
				<a href="example1.html">Example 1</a><br />
				<a href="example2.html">Example 2</a><br />
				<a href="example3.html">Example 3</a><br />
				<a href="example4.html">Example 4</a><br />
				<a href="allExamples.html">All Examples</a><br />
				<a href="allExamplesCompiled.html">All Examples Compiled</a><br />
			<a href="http://groups.google.com/group/Pure-Unobtrusive-Rendering-Engine/post">Post</a> or <a href="mailto:Pure-Unobtrusive-Rendering-Engine@googlegroups.com">mail us</a><br /> your feedback
		</div>
		<h3>Example 1: Hello Who?</h3>
		<div class="demo">
			<a href="#" onclick="render1();return false;">render</a>
			<div class="htmlDoc">
				<div id="hello"> 
					Hello <span class="who firstName">World</span>
				</div>
			</div>
			<div class="transformation">
				<div id="render1"></div>
			</div>
		</div>
		<h3>Example 2: Iteration on a table</h3>
		<div class="demo">
			In addition to the iteration, this example shows a way to attach events by a directive.<br />
			Mouse over the lines of the rendered table, and click on a line.<br/>
			<div class="htmlDoc">
				<a href="#" onclick="render2();return false;">render</a>
                <table class="players"><thead><tr><th class="player">Player</th></tr></thead><tbody><tr><td class="player">Chloe</td></tr></tbody></table>
			</div>
			<div class="transformation">
				<div id="render2"></div>
			</div>
		</div>
		<h3>Example 3: Iteration on a list</h3>
		<div class="demo">
			<div class="htmlDoc">
				<a href="#" onclick="render3();return false;">render</a>
				<ol class="teamList">
					<li class="player sites"><a class="name url@href" href="http://beebole.com">Beebole</a></li>
				</ol>
			</div>
			<div class="transformation">
				<div id="render3"></div>
			</div>
		</div>
		<h3>Example 4: Passing a JS function as a directive (Iteration on a table zebra like)</h3>
		<div class="demo">
			<div class="htmlDoc">
				Here the target and the source HTML are the same. The HTML will replace itself.<br /> 
				<a href="#" onclick="render4();return false;">render</a>
			</div>
			<div class="transformation">
				<div id="render4">
	                <table class="players 2">
	                    <thead><tr><th class="player">Player</th></tr></thead>
	                    <tbody><tr><td class="player">Chloe</td></tr></tbody>
	                </table>
				</div>
			</div>
		</div>
		<h3>Example 5: Nested Iteration</h3>
		This was not explained in the examples. The objective here is to have a double iteration. First on teams, then on players.<br />
		It shows the nested iteration and as well how a template can be included in another.
		<div class="demo">
			<div class="htmlDoc">
				<a href="#" onclick="render5();return false;">render</a>
				<table class="scoreBoard">
				    <tbody>
				        <tr>
				            <td class="teamName">Team Name</td>
				            <td class="teamPlace">
				                <table class="teamList">
				                    <thead><tr><th class="position">Position</th><th class="player">Player</th><th class="score">Score</th></tr></thead>
				                    <tbody><tr><td class="position">1</td><td class="player">Chloe</td><td class="score">20</td></tr></tbody>
				                </table>
				            </td>
				        </tr>
				    </tbody>
				</table>
			</div>
			<div class="transformation">
				<div id="render5"></div>
			</div>
		</div>
		<h3>Example 6: Recursive List (the recursion is not dynamic)</h3>
		<div class="demo">
			<div class="htmlDoc">
				<a href="#" onclick="render6();return false;">render</a>
				<ul  id="nav"> 
					<li><a href="#">About</a> 
						<ul class="nav1"> 
							<li><a href="#">Offices</a>
								<ul class="nav2">
									<li><a href="#">Brussels</a></li> 
								</ul>
							</li> 
						</ul> 
					</li> 
				</ul>
			</div>
		</div>

		<h3>Compile your HTML's into Javascript and save some Kb</h3>

		<p class="note"><p><input onclick="renderAll();$p.getRuntime(this);return false" value="get the PURE runtime file" type="button"></input></p>
		<textarea id="pureRuntime">Click the button above to get all the HTML compiled to a JS file. The screen may scroll a little.</textarea>
		<p>Copy paste the content of the text area above to a JS file. Save it. You can even minify and/or gzip it.<br />
		Then include this JS file in your pages. Your compiled HTML's will be available and cached by the browser as any other JS file.</p>
		<p>Then you can save some additional Kb from your page, by removing pure.js and all the code that set the directives, and compile.<br />
		Here is an example of <a href="allExamplesCompiled.html">a page that uses compiled templates</a><br />
		Note that if you remove pure.js, you won't be able to generate templates on the fly, so a mix is probably the best approach.</p>
	</body>
</html>