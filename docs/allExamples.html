<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:pure="http://beebole.com/pure">
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>The Features of PURE Unobtrusive Rendering Engine for HTML</title>
	    <link href="white.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			#pureRuntime{width:100%;height:200px;background-color:#DEF}
			.htmlDoc{width:90%;background-color:#def;}
			.transformation{width:90%;background-color:#DEF;}
			.demo{border:solid 1px #ccc;background-color:#def;padding:10px}
		</style>
		<script type="text/javascript" src="../js/jqueryMin.js"></script>
		<script type="text/javascript" src="../js/pure.js"></script>
		<script type="text/javascript">

		/* * * * * * * * * * * * * * * * * * * * * *
		 *     E X A M P L E      1 
		 * * * * * * * * * * * * * * * * * * * * * */			
			function render1(){
				$('#hello').autoRender({ "who": "Mary" });}

			/* Note: 
			  All the notation below are possible with different results:				

				a) as above. replacing the html by itself transformed with the data
					$('#hello').autoRender({ "who": "Mary" })

				b) replacing the target by the html transformed
					$('#hello').autoRender({ "who": "Mary" }, $('#target1'));
				
				
				c) Replacing the content of a target
					$('#target1').html( $p.autoRender($('#hello')[0], { "who": "Mary" }));


				d) same as c) but without js framework (jQuery)
					var target = document.getElementById('target1'); 
					var html = document.getElementById('hello');
					var data = { "who": "Mary" };
					target.innerHTML = $p.autoRender( html, data );
			*/


		/* * * * * * * * * * * * * * * * * * * * * *
		 *     E X A M P L E      2 
		 * * * * * * * * * * * * * * * * * * * * * */			
			function render2(){
				var context = ["Alice Keasler", "Charles LeGrand", "Gary Bitemning", "Helen Moren"];
				$('table.players.1').autoRender(context);}
		
		/* * * * * * * * * * * * * * * * * * * * * *
		 *     E X A M P L E      3 
		 * * * * * * * * * * * * * * * * * * * * * */			
			function render3(){
				var context = {
					"id": "3456",
					sites: [{ 
						"name": "Beebole","url": "http://beebole.com"}, {
						"name": "BeeLit", "url": "http://beeLit.com"}, {
						"name": "PURE",	  "url": "http://beebole.com/pure"}]};
				
				$('ol.teamList').autoRender( context);}

			/* Note: 
			 	to access the attributes of the root of the html use a directive as above for the id.
				Only the name of the attribute is provided between brackets
				For auto-rendering use the @ symbol as: property@attribute
				i.e: url@href
			*/
		
		/* * * * * * * * * * * * * * * * * * * * * *
		 *     E X A M P L E      4 
		 * * * * * * * * * * * * * * * * * * * * * */			
			function lineClick(name){ alert(name); } // example1 of event attachment

			function swapStyle(obj, inOut){ // example2 for mouseover, mouseout
				obj.className = (inOut) ? 'player hover' : 'player';};

			function render4(button){
				// simulate a ajax-jsonp call, that will load here a static js, and call the example4CallBack function
				button.value = 'loading data...';
				var script = (button.id == 'b4_2') ? 'jsonBig.js':'jsonSmall.js';
				$.getJSON(script, function(context){

					var directive = {
					'tbody tr td[onclick]':function(context,items, pos){ return 'lineClick(\''+items[pos]+'\');'},
					'tbody tr td[onmouseover]': '"swapStyle(this, true);"',
					'tbody tr td[onmouseout]' : '"swapStyle(this, false);"', //both '"..."' and "'...'" work now
					'tbody tr td[style]':"'cursor:pointer'",
					'tbody tr[class]+': function(context, items, pos){
											var oddEven =  (pos % 2 == 0) ? 'even' : 'odd';
											var firstLast = (pos == 0) ? 'first': (pos == items.length -1) ? 'last':'';
											return oddEven + ' ' + firstLast; }}

					$('table.players.2').autoRender(context, directive);

					button.value = 'Refresh the page to render again.';});}


			/*Note: 
				by default a directive replace the content of the selected node or attribute
				If an append or prepend is necessary we use +
				+<selector> means prepend the directive to the existing selected content
				<selector>+ means append the directive to the existing selected content

				Here as well is an example of attaching events to the HTML.
				Not sure if there is another way of passing such objects to the transformation.
				It has de advantage of not having to parse again the html to attach events after the transformation.
			 */
			
		/* * * * * * * * * * * * * * * * * * * * * *
		 *     E X A M P L E      5 
		 * * * * * * * * * * * * * * * * * * * * * */			
			var row = {
				odd: 'odd',
				even:'even',
				decorator: function(context, items, pos){
					return (pos % 2 == 1) ? this.even : this.odd;}}
					
			function lineNb(context, items, pos){
				return pos+1;}

			function render5(){
				var context = {
					'list': [['Cats', 
								[["Alice Keasler", 14], ["Charles LeGrand", 13],["Gary Bitemning", 20],["Helen Moren", 5]]], 
							['Cows', 
								[["Mary Cain", 15], ["Vicky Benoit", 5], ["Wayne Dartt", 11]]],
							 ['Dogs', 
							 	[["Ray Braun", 13], ["Aaron Ben", 24], ["Steven Smith", 1], ["Kim Caffey", 19]]], 
							['Donkeys', 
								[["Natalie Kinney", 16], ["Caren Cohen", 3]]]]};
				
				var scoreBoard = $('table.scoreBoard').$pMap({
					'tbody tr': 'teams <- list',
					'td.teamName': 'teams[0]'
				});
				
				var teamList = $('table.teamList', scoreBoard)
					.$pMap({
						'tbody tr': 'player <- teams[1]',
						'td.player': 'player[0]',
						'td.score': 'player[1]',
						'td.position': lineNb, //passing the pointer of a function that does not use "this"
						'tbody tr[class]': function(context, items, pos){ return row.decorator(context, items, pos) } }); //show how to wrap a method and not breack the use of "this"
				
				$('td.teamPlace', scoreBoard).html(teamList); //place sub-template teamList in scoreBoard
				$p.compile(scoreBoard, 'f5'); //compile to a function
		        $('div#render5').html( $p.render('f5', context) );} //place the result of the transformation to the innerHTML of div#render5

		/* Note: 
			Here we compile the HTML to a function called f5.
			This function can then be saved in a js file(using the $p.getRuntime method)
			and called by the function render as above
		*/

		/* * * * * * * * * * * * * * * * * * * * * *
		 *     E X A M P L E      6 
		 * * * * * * * * * * * * * * * * * * * * * */			
			function render6(){
				var context = [ 
					{"name" : "Home", "url" : "#ho"}, 
					{"name" : "About", "url" : "http://about...", 
						"subMenu" : [
							{"name" : "History", "url" : "http://history..."},
							{"name" : "Team", "url" : "http://team..."},
							{"name" : "Offices", "url" : "http://offices...",
								"subMenu" : [
									{"name" : "Brussels", "url" : "http://brussels..."},
									{"name" : "New Delhi", "url" : "http://newdelhi..."}]}]},
			        {"name" : "Services", "url" : "http://services...",
						"subMenu" : [
							{"name" : "Web Design", "url" : "http://web..."},
							{"name" : "Development", "url" : "http://dev..."}]}];
			               
				var directive = {
				  "li" : "menu <-",
				  "a" : "menu.name", 
				  "a[href]" : "menu.url",
			     	  "ul.nav1 li" : "sub1 <- menu.subMenu",
			     	  "ul.nav1 li a" : "sub1.name", 
				  "ul.nav1 li a[href]" : "sub1['url']", //other notation of sub1.url
			     	  "ul.nav2 li" : [ "sub2 <- sub1.subMenu", "sub2['name']"]};
				
				$('ul#nav').compile('f6', directive);
				$('ul#nav').render(context, 'f6');}
				
		/*Note: 
			the last directive is an array instead of a string. This is useful
			when we want to set various directives on the same node.
		*/
		

		//nothing with PURE here, just some utility for this page
			function clickButton(obj, render){
				obj.disabled = true;
				obj.value = 'Refresh the page to render again.';
				if (arguments[2]) 
					$(arguments[2]).remove();
				if (/Firefox/i.test(navigator.userAgent)) 
					obj.type = 'submit';//to have buttons back when refreshing the page in FF
				render(obj);
			}
		</script>
	</head>
	<body>
 		<div class="links"><a href="allExamples.html">All Examples</a><br />
				<a href="howToCompile.html">How to compile your html</a><br />
				<a href="allExamplesCompiled.html">All Examples Compiled</a><br />
			<a href="http://groups.google.com/group/Pure-Unobtrusive-Rendering-Engine/post">Post</a> or <a href="mailto:Pure-Unobtrusive-Rendering-Engine@googlegroups.com">mail us</a><br /> your feedback
		</div>
		<!-- 
	/* * * * * * * * * * * * * * * * * * * * * *
	 *     E X A M P L E      1 
	 * * * * * * * * * * * * * * * * * * * * * */			
		-->
		<h1>What are the features available in PURE today ?</h1>
		This page groups all the features available in the last release.<br />
		Click the render buttons to see the result.<br />
		Look at the source of the page to see comments and usage.
		<h3>Example 1: Hello Who?</h3>
		<div class="demo">
			<input type="button" onclick="render1();" value="render" />
			<div class="htmlDoc">
				<div id="hello">
					Hello <span class="who">World</span>
				</div>
			</div>
			<div id="target1"></div>
		</div>
		<!-- 
	/* * * * * * * * * * * * * * * * * * * * * *
	 *     E X A M P L E      2 
	 * * * * * * * * * * * * * * * * * * * * * */			
		-->
		<h3>Example 2: Iteration on a Table</h3>
		<div class="demo">
			<div class="htmlDoc">
				<input type="button" onclick="clickButton(this, render2);" value="render" />
				<table class="players 1">
					<thead>
						<tr><th class="player">Player</th></tr>
					</thead>
					<tbody>
						<tr class="context">
							<td class="player context">Chloe</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<!-- 
	/* * * * * * * * * * * * * * * * * * * * * *
	 *     E X A M P L E      3 
	 * * * * * * * * * * * * * * * * * * * * * */			
		-->
		<h3>Example 3: Iteration on a List</h3>
		<div class="demo">
			<div class="htmlDoc">
				<input type="button" onclick="clickButton(this, render3);" value="render" />
				<!-- note the notation "data property"@"attribute name"-->
				<ol class="teamList id@id">
					<li class="player sites"><a class="name url@href" href="http://beebole.com">Beebole</a></li>
				</ol>
			</div>
		</div>
		<!-- 
	/* * * * * * * * * * * * * * * * * * * * * *
	 *     E X A M P L E      4 
	 * * * * * * * * * * * * * * * * * * * * * */			
		-->
		<h3>Example 4: Passing JS Functions as a Directive (Iteration on a table zebra like and attach events)</h3>
		<div class="demo">
			<div class="htmlDoc">
				<input id="b4_1" type="button" onclick="clickButton(this, render4, '#b4_2');" value="render" />
				<input id="b4_2" type="button" onclick="clickButton(this, render4, '#b4_1');" value="render with 500 lines..." />
				<table class="players 2">
					<thead>
						<tr>
							<th class="player">Player</th>
						</tr>
					</thead>
					<tbody>
						<tr class="context">
							<td class="player context">Chloe</td>
						</tr>
					</tbody>
				</table>
			</div>
			In addition to the zebra iteration, this example shows a way to attach events by a directive.<br />
			Mouse over the lines of the rendered table, and click on a line.<br/>
		</div>
		<!-- 
	/* * * * * * * * * * * * * * * * * * * * * *
	 *     E X A M P L E      5 
	 * * * * * * * * * * * * * * * * * * * * * */			
		-->
		<h3>Example 5: Nested Iteration</h3>
		This was not explained in the examples. The objective here is to have a double iteration. First on teams, then on players.<br />
		It shows the nested iteration and as well how a template can be included in another.
		<div class="demo">
			<div class="htmlDoc">
				<input type="button" onclick="render5();" value="render" />
				<table class="scoreBoard">
					<tbody>
						<tr>
							<td class="teamName">Team Name</td>
								<td class="teamPlace">
								<table class="teamList">
									<thead>
										<tr><th class="position">Position</th><th class="player">Player</th><th class="score">Score</th></tr>
									</thead>
									<tbody>
										<tr><td class="position">1</td><td class="player">Chloe</td><td class="score">20</td></tr>
									</tbody>
								</table>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div class="transformation">
				<div id="render5"></div>
			</div>
		</div>
		<!-- 
	/* * * * * * * * * * * * * * * * * * * * * *
	 *     E X A M P L E      6 
	 * * * * * * * * * * * * * * * * * * * * * */			
		-->
		<h3>Example 6: Recursive List - the recursion is not (yet) dynamic :(</h3>
		<div class="demo">
			<div class="htmlDoc">
				<input type="button" onclick="clickButton(this, render6);" value="render" />
				<ul id="nav"> 
					<li><a href="#">About</a> 
						<ul class="nav1"> 
							<li><a href="#">Offices</a>
								<ul class="nav2">
									<li><a href="#">Brussels</a></li> 
								</ul>
							</li> 
						</ul> 
					</li> 
				</ul>
			</div>
		</div>
	</body>
</html>