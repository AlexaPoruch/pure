<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:pure="http://beebole.com/pure">
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>PURE Unobtrusive Rendering Engine for HTML - Speed Test</title>
    	<link href="white.css" rel="stylesheet" type="text/css" />
		<script src="../js/jquery.js"></script>
		<script src="../js/pure.js"></script>
		<script src="../js/pure2.js"></script>
	</head>
	<body class="allExamples">
 		<h3>Various comparisons</h3>
		<div class="demo">
			<div class="htmlDoc">
				<p>Do it <input id="loops" type="text" size="3" value="100" /> times</p>
				<input type="button" onclick="runtests('small');" value="render" />
				<input type="button" onclick="runtests('big');" value="render with 500 lines..." />
				<div id="timer"></div>
				<div id="target">
					<table class="players">
						<thead>
							<tr>
								<th class="player">Player</th>
							</tr>
						</thead>
						<tbody>
							<tr class="context">
								<td class="player context">Chloe</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<!-- 
	/* * * * * * * * * * * * * * * * * * * * * *
	 *     Hidden templates 
	 * * * * * * * * * * * * * * * * * * * * * */			
		-->
		<div class="templates">
			<table class="players">
				<thead>
					<tr>
						<th class="player">Player</th>
					</tr>
				</thead>
				<tbody>
					<tr class="context">
						<td class="player context">Chloe</td>
					</tr>
				</tbody>
			</table>

			<div class="timerTrace">
				Avg: <span class="avg"></span>
				<table class="timerTraceTable">
					<thead>
						<tr><th class="timerMsg">(ms)</th><th class="timerDuration">Duration</th><th class="timerTime">Timer</th></tr>
					</thead>
					<tbody>
						<tr class="context"><td class="timerMsg">Start</td><td class="timerDuration">0</td><td class="timerTime">0</td></tr>
					</tbody>
				</table>
			</div>
		</div>
<script>
(function(){
	var jsonBig = {players:["Aaron Chong","Adam Hudgings","Adam Powell","Adrian Barcio","Adrian Barcio","Adrian Meador","Adrian Pippenger","Aimee Cole","Aimee Wagner","Alejandro Gross","Alejandro Puckett","Alex Boyes","Alex Gardner","Allen Church","Allison Nazzal","Alyssa Ascenzo","Alyssa Stugart","Amy Haven","Andrew Bavinger","Andrew Minkoff","Andrew Ritchie","Andrew Rosenberg","Andy Brumley","Andy Mullins","Andy Rein","Angel Chong","Angel Granlund","Ann Berger","Ann Greene","Ann Haven","Anna Carlson","Anna Garza","Anna McMahan","Anna Pickett","Anne Berggren","Anne Elliott","Anne Maddox","Anne McFarland","Annie Darley","Annie Davila","Annie DeHart","Annie Paige","Anthony Caffrey","Anthony Leatherbury","Anthony Noyes","Art Grant","Art Ryan","Arthur Carmichael","Arthur Gelder","Barbara Kicinski","Barbara Wright","Barry Gilpin","Barry Gomez","Barry Leslie","Bart Tchainikov","Beatrice Carnes","Beatrice Tolle","Ben Rittenbach","Benjamin Dowd","Beth Schneider","Beth Wise","Betty Mirza","Betty Tatum","Bill Mathis","Bill Steen","Bill Reiter","Bobby Blume","Bobby Gardner","Brad Barton","Brad Foster","Brenda Elders","Brenda Glantz","Brenda Gomez","Brenda Howell","Brenda Langston","Brett Briggs","Brian Frantom","Bruce Arntzen","Bruce Hamilton","Bryan Ball","Bryan Nolan","Bryan Thomas","Candace Applegate","Candace Sands","Candace Wiediger","Cara Hawkins","Cara Mirza","Cara Steen","Cara Ouellette","Caren Boyd","Carlos Cousins","Carlos Elizabeth","Carlos Scott","Carol Haley","Carol Jarrell","Carol Russell","Caroline Halladay","Caroline Martin","Carolyn Baer","Carolyn Davis","Carolyn Drescher","Carolyn Herman","Carolyn Huffman","Carolyn Stone","Carrie Workman","Cassandra Paul","Catherine Barreto","Catherine Gerbode","Catherine Harrison","Chad Carson","Chad Hochman","Chad Moore","Chad Reichenbach","Chad Steele","Chad Whitaker","Charlotte Harrison","Chris Pfeiffer","Chris Varela","Chrissy Barkauskas","Chrissy Moren","Chrissy Ratner","Christen Eichhorn","Christen Martisek","Christen Rein","Christine Church","Christine Spencer","Christine Vanderzanden","Christopher Powers","Christy Szafranski","Christy West","Chuck Tran","Claire Crain","Claire Luers","Claudia Andreou","Claudia Ferguson","Claudia Meador","Claudia Polk","Corey Cartwright","Corey Moren","Courtney Burns","Courtney Cabrera","Courtney Matt","Courtney Sims","Courtney Southworth","Courtney Wise","Craig Barreto","Craig Crawford","Craig Kelty","Cynthia Bricout","Cynthia Litvak","Dan Glaze","Dan Reifel","Dan Sherrill","Dana Kramer","Daniel Gibson","Darren Boyd","Darren Kiefer","Darren Payne","David Degenhardt","David Gobble","David Oliver","Dean Lomonaco","Deanne McGarr","Deborah Zitterkopf","Denise Brumfield","Denise Overfelt","Dennis McAdams","Denny Clark","Denny Nunn","Denny Polk","Derek Dakoulas","Derek Day","Derek Fowler","Derek Ruthruff","Diane Daugherty","Dianne Briggs","Dianne Hansen","Dianne Holloman","Dianne Williams","Don Hooks","Don Wilson","Dorothy Hood","Dorothy Sherrill","Doug Flanagan","Edward Arenson","Edward Fletcher","Edward McAdams","Eileen Bennett","Eileen Prischmann","Elena McAlexander","Elizabeth Barnwell","Elizabeth Hutchinson","Elizabeth Mirza","Emily Stepp","Eric Cano","Eric Towns","Eric Wendt","Erica Morse","Erica Murray","Erin Arbore","Erin Deggeller","Erin Elijah","Erin Fredericks","Erin LaValle","Erin Swaim","Erin Weidenfeller","Eugene Harrigan","Eugene Kuhlken","Frances McGoldrick","Frank Barcio","Frank Holzer","Fred Catlett","Fred Epp","Fred McMahan","Gary DeVincentis","Gene Hendricks","George Elders","George Epp","George Gartler","George Scales","Gina Ongley","Giulietta Baxter","Giulietta Mull","Giulietta Patton","Giulietta Scales","Giulietta Tyree","Gordon Elliott","Gordon Powers","Greg Mullet","Greg Ralston","Greg Taslimi","Greg Webber","Harry Eplett","Heather Duckworth","Heather McMath","Heather Schafer","Helen Farhat","Helen Fortune","Helen Hale","Henry King","Hunter Cazamias","Ivan Nassar","James Weien","Jamie Moss","Janet Kimmel","Janet Visinsky","Jay Karlsson","Jay Lock","Jay Murphey","Jeff Belusar","Jeff Hudgings","Jeff Steele","Jeff Towns","Jeffrey Bowman","Jeffrey Robinson","Jenna Murray","Jennifer Fergusson","Jennifer Ouellette","Jessica Stacy","Jim Nockton","Joanna McCarthy","Joe Chen","Joe Frantom","Joe Irving","Joel Carter","John Cavallaro","John Lampkin","Jonathan Long","Jonathan Ober","Jonathan Tunison","Joseph Monk","Joseph Sweed","Joyce Karlin","Juliana Dodds","Julie Lassiter","Justin Athanas","Justine Cheville","Justine Speight","Justine Steele","Kara McCord","Karen Griffin","Karen Kirby","Katharine Baer","Katharine Barbee","Katharine Kirby","Katharine Pardue","Katherine Currie","Katherine Kavanagh","Kathleen Overcash","Kathryn Marie","Kathryn Olson","Katrina Kirby","Katrina Miner","Kelly Corbett","Kelly Taylor","Kelly Venier","Ken Owens","Ken Ray","Kerry Culpepper","Kevin Kaydos","Kimberly Dobson","Kimberly Spencer","Kimberly Steinke","Kristina Fletcher","Kristina Thurman","Kristine Dakoulas","Kristine Gilyot","Kristine Hawkins","Kristine Younan","Laura Butterfield","Laura Flathmann","Laura Reichenbach","Laura Woodbury","Laurel Feldman","Laurel Seay","Lauren Baker","Lauren Karlin","Laurie Payne","Laurie Pond","Leah Braunhardt","Leah Francis","Leah Keleher","Linda Blume","Linda Monton","Linda Odegard","Lisa Hochman","Lisa Jarrell","Lisa Rozendal","Logan Barnes","Logan Puckett","Logan Rosenberg","Lori Mazurek","Marc Andreou","Marc Crain","Marc White","Margaret Mebane","Maria Kirby","Marie Boucher","Marie Cavallaro","Marie Denney","Marie Murry","Marie Rhinehart","Marisa Phelps","Marisa Scheer","Marisa Weirich","Mark Bess","Mark Garneau","Martha Cusey","Martha Perlioni","Martha Solomon","Mary Arenson","Mary Fergusson","Mary Fossati","Mary Merwin","Mary Parks","Mary Perez","Matthew Cooley","Matthew Foulston","Matthew Kielt","Matthew Paul","Maya Kirk","Maya Lawera","Melanie Barnwell","Melissa Byon","Melissa House","Melissa Shaw","Michael Nguyen","Michelle Hooks","Michelle Horne","Mike McClure","Monica Odegard","Monica Tyree","Monica Vanderzanden","Nancy Haas","Natalie Nolan","Nathan Avila-Sakar","Nathan Sumrall","Nathan Young","Nicole Barnwell","Nicole MacLeod","Nina Fergusson","Pamela Collier","Pamela Shampine","Patricia Hellums","Perry Buhler","Perry Spear","Peter Connell","Philip Whitley","Phillip Collier","Phillip Taylor","Randy Haley","Rebecca Bierner","Rebecca Brown","Rebecca Nockton","Ricardo Holt","Richard MacLeod","Richard Millard","Richard Tate","Rick Leslie","Rick Szafranski","Rob Carey","Rob Overfelt","Rob Stugart","Rod Kang","Roger Boyd","Roger Kamine","Ross Lloyd","Ross Wiediger","Ruben Bolding","Russell Kelly","Russell Thomson","Ryan Hunt","Sam Manning","Sandra Chance","Sandra Goldwyn","Sandra Holt","Sandra Pistole","Scot Dakoulas","Scot Stuckey","Scott Cave","Scott Thurman","Sean Segura","Sharon Granlund","Shaun Carroll","Shaun Claude","Shaun Cousins","Shaun Ewing","Shaun Howard","Shaun Warnes","Sheri Flanagan","Sheri Nordlander","Sonia Norvell","Stefanie Hirsh","Stefanie Raglin","Stephanie Rhinehart","Stephen Beusse","Stephen Odegard","Steven Crowder","Steven Elders","Stuart Bradley","Stuart Carmichael","Stuart Gomez","Susan Breyer","Suzanne Gillingham","Sylvia Rosemblun","Sylvia Taslimi","Tara Kim","Tatiana Brooks","Ted Pounds","Terri Blair","Terri Boeckenhauer","Terri Buhler","Theresa Cartwright","Theresa Dilbeck","Theresa Glaze","Thomas Holder","Tiffany Cox","Tiffany Ouellette","Tiffany Reddy","Tiffany Stivers","Tiffany Thompson","Tim Howley","Toby Capri","Toby Gilyot","Toby Goffin","Toby Scott","Toby Talwar","Todd Swift","Tom Collier","Tom Horne","Tom Sammartino","Tracy Dartt","Tracy Doherty","Tracy Love","Tracy Moss","Tracy Mull","Troy Cowsar","Troy Haushalter","Valerie Paige","Valerie Schoenberger","Veronica Hall","Veronica Kaydos","Vicky Brumfield","Vicky Denison","Vicky Rupert","Vicky Staebel","Vivian Church","Vivian Millard","Wade Honeyman","Wade Price","Wade Rider","Walter Hagelstein","Wayne Avila-Sakar","Wayne Bray","Wayne Caesar","Wayne Etezadi","Wendy Leatherbury","William Owens"]};
		var jsonSmall = {players:["Adrian Meador","Bryan O'Connor","Michèle Noïjû","تصبح عالميا مع يونيكود","Γέφυρα γρύλων","Chloé Ellemême","глобальных масштабах","יוצא לשוק העולמי","La \"volante\"","Todd Swift","Valerie Paige","Walter Hagelstein","Wendy Leatherbury"]};

	var pure1directive = {			
		'tbody tr':'player <- players',
		'td':'player'
	};

	var pure2directive = {
		'tbody tr':{
			'player <- players':{
				'td':'player'
			}
		}
	};

	var template = $('div.templates table.players');
	var target = $('#target').get(0);

	var tests = {
		'pure1, compile-render each loop': function(loops, context){
			var directive = pure1directive;
			var tpl = template[0].cloneNode(true);
			timer.start();
			while(loops--){
				target.innerHTML = $p.render(tpl, context, directive);
			}
			timer.stop();
		},
		'pure2, compile-render each loop': function(loops, context){
			var directive = pure2directive;
			timer.start();
			while(loops--){
				target.innerHTML = jQuery.pureCompile(template, directive)(context);
			}
			timer.stop();
		},
		'pure1, compiled once, render each loop': function(loops, context){
			var tpl = template[0].cloneNode(true);
			timer.start();
			template.compile('puretest', pure1directive, context);
			while(loops--){
				target.innerHTML = $p.render(tpl, context, false, 'puretest');}
			timer.stop();
		},
		'pure2, compiled once, render each loop': function(loops, context){
			var directive = pure2directive;
			timer.start();
			var rfn = jQuery.pureCompile(template, directive);
			while(loops--){
				target.innerHTML = rfn(context);
			}
			timer.stop();
		},
		'pure1, compile only': function(loops, context){
			var tpl = template[0].cloneNode(true);
			timer.start();
			while(loops--){
				template.compile('puretest', pure1directive, context);
			}
			timer.stop();
		},
		'pure2, compile only': function(loops, context){
			var directive = pure2directive;
			var target = $('#target');
			timer.start();
			while(loops--){
				jQuery.pureCompile($('div.templates table.players'), directive);
			}
			timer.stop();
		},
		'pure1, render only': function(loops, context){
			var tpl = template[0].cloneNode(true);
			timer.start();
			template.compile('puretest', pure1directive, context);
			while(loops--){
				var h = $p.render(tpl, context, false, 'puretest');}
			timer.stop();
		},
		'pure2, render only': function(loops, context){
			var directive = pure2directive;
			var target = $('#target');
			timer.start();
			var rfn = jQuery.pureCompile($('div.templates table.players'), directive);
			while(loops--){
				var h = rfn(context);}
			timer.stop();
		}
	};

	runtests = function(which){
		var loops = parseInt($('input#loops')[0].value);
		var context = (which == 'big') ? jsonBig:jsonSmall;
		for(var t in tests){
			timer.newtest(t, loops);
			tests[t](loops, context);
		}
		$('div#timer').html(timer.summary('(ms, avg of ' + loops + ' reps)'));
	}

	var now = function(){
		var now = new Date();
		return now.getTime();
	};

	var timer = {
		times: [],
		newtest: function(name, loops){
			this.name = name;
			this.loops = loops;
		},
		start: function(){
			this.t0 = now();
		},
		stop: function(){
			var t = now();
			this.times.push({
				name: this.name,
				time: (t - this.t0) / this.loops
			});
		},
		summary: function(title){
			var html = ['<table class="timerTraceTable"><thead><tr><th class="timerMsg">' + title + '</th><th class="timerDuration">Duration</th></tr></thead><tbody>'];
			for(var i = 0; i < this.times.length; i++){
				var t = this.times[i];
				html.push([
					'<tr class="context"><td class="timerMsg">', 
					t.name,
					'</td><td class="timerDuration">',
					t.time,
					'</td></tr>'].join(''));
			}
			html[html.length] = '</tbody></table>';
			return html.join('');
		}
	};
})();
</script>		
	</body>
</html>